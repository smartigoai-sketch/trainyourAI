<!DOCTYPE html>
<html lang="en">
<head>
<script src="https://js.stripe.com/v3"></script>  
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Smartigo PRO — 10-Day Training</title>
<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet"/>
<link rel="icon" href="/smartigo-logo.png" type="image/png"/>
<style>
  :root{
    --bg:#0b0b0f;--card:#121218;--text:#eaeaf2;--muted:#a8a8b3;
    --accent1:#5dcdf0;--accent2:#8d7cfb;--border:#1d1d26;
  }
  *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,sans-serif;}
  .container{max-width:1120px;margin:0 auto;padding:20px}
  .form{max-width:720px;margin:60px auto;background:var(--card);border:1px solid var(--border);padding:28px}
  h1{margin:0 0 8px;font-size:28px;line-height:1.2;text-align:center}
  p.lead{color:var(--muted);text-align:center;margin:0 0 16px}
  label{display:block;margin:16px 0 8px;color:var(--muted)}
  input[type=email]{width:100%;padding:12px;background:#16161f;border:1px solid var(--border);color:var(--text);border-radius:4px}
  .btn{display:inline-block;width:100%;margin-top:16px;padding:12px 18px;border:none;border-radius:0;
       font-weight:700;cursor:pointer;background:linear-gradient(135deg,var(--accent1),var(--accent2));color:#0b0b0f}
  small{color:var(--muted)}
  .nav{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:14px 0;border-bottom:1px solid var(--border)}
  .nav a{color:var(--muted);text-decoration:none}
</style>
</head>
<body>
  <header class="container">
    <div class="nav">
      <a href="/" aria-label="Home" style="display:flex;align-items:center;gap:8px">
        <img src="/smartigo-logo.png" width="32" height="32" alt="Smartigo"/>
        <strong style="letter-spacing:.3px;color:var(--text)">Smartigo</strong>
      </a>
      <nav style="display:flex;gap:16px">
        <a href="/">Home</a>
        <a href="/pro" style="color:var(--accent1)">PRO</a>
      </nav>
    </div>
  </header>

  <main class="container">
    <div class="form">
      <h1>Smartigo PRO</h1>
      <p class="lead">10 giorni di workflow avanzati, template pronti e guida operativa — <strong>€9.99</strong>.</p>

      <label>Email</label>
      <input id="proEmail" type="email" placeholder="your@email.com" />
      <small>La precompiliamo dal percorso free; puoi modificarla.</small>

      <button id="pro-cta" class="btn btn-primary">Go PRO - 9.99</button>
      <p style="color:var(--muted);font-size:.92rem;margin-top:12px;text-align:center">
        Pagamento sicuro con Stripe. Ricevi subito la ricevuta.
      </p>
    </div>
  </main>

<script>
(function(){
  // 1) Precompila email da query (?email=...) o localStorage
  const params = new URLSearchParams(location.search);
  const input  = document.getElementById('proEmail');
  const fromQuery = params.get('email') || '';
  const saved = localStorage.getItem('smartigo_email') || '';
  input.value = fromQuery || saved;

  function persistEmail(){
    const v = (input.value||'').trim();
    if(v) localStorage.setItem('smartigo_email', v);
  }
  input.addEventListener('input', persistEmail);

  // 2) Vai a Stripe Payment Link
  const STRIPE_LINK = 'https://buy.stripe.com/test_eVq28r9igeUMcmpbCbak001'; // <-- INCOLLA QUI
  document.getElementById('proCta').addEventListener('click', function(){
    persistEmail();
    if(!input.value.trim()){ alert('Please enter your email to proceed.'); input.focus(); return; }
    window.location.href = STRIPE_LINK;
  });
})();
</script>
 <script>
  // 1) METTI QUI LA TUA PUBLISHABLE KEY STRIPE (TEST)
  const STRIPE_PK = 'pk_test_51SQ9KiGZ2xVM8libIulUVOWFgwQMpXAbPyOjn2nGWblTpFGbFDlaHwWfMe146sed6cR1TRFqVdZSosP4PD4oBxc100Cy6YllFQ';

  // 2) METTI QUI IL TUO PRICE ID STRIPE (TEST)
  const PRICE_ID  = 'price_1SQR3GGZ2xVM8libpFAwKK0z';

  // 3) METTI QUI L’URL DELL’APPS SCRIPT (QUELLO DEL DEPLOY)
  const APPS_SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwGOZPX8cFOElL1MpHH5YD_SRpD6Jl2zSkoigB8RxQOC1LulqMSZty5A_-yJ4-fvKOKTA/exec';

  // Se l’email è in querystring ?email=... la prendiamo.
  // In alternativa proviamo da localStorage (se l’hai salvata dopo il quiz).
  function getUserEmail() {
    const qs = new URLSearchParams(location.search);
    const fromQS = qs.get('email');
    if (fromQS) return fromQS;
    try { return localStorage.getItem('smartigo_email') || ''; } catch(e){ return ''; }
  }

  // Inizializza Stripe
  const stripe = Stripe(STRIPE_PK);

  async function startProCheckout() {
    const email = getUserEmail();
    if (!email) {
      alert('Please enter your email first so we can activate PRO.');
      return;
    }

    // Apri Checkout Stripe (TEST). Alla fine torna su /pro/success
    await stripe.redirectToCheckout({
      mode: 'payment',
      lineItems: [{ price: PRICE_ID, quantity: 1 }],
      customerEmail: email,
      clientReferenceId: email,
      successUrl: 'https://smartigoai.eu/pro/success?email=' + encodeURIComponent(email),
      cancelUrl: 'https://smartigoai.eu/pro?canceled=1'
    });
  }

  document.addEventListener('DOMContentLoaded', () => {
    const btn = document.getElementById('pro-cta');
    if (btn) btn.addEventListener('click', startProCheckout);
  });
</script>
 
</body>
</html>
